(()=>{"use strict";var e,t={731:()=>{const e=window.React,t=window.wp.blocks,n=window.wp.i18n,r=window.wp.blockEditor,o=window.wp.components,a=[{id:"chart-bar",label:"Chart Bar",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>'},{id:"chart-line",label:"Chart Line",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/></svg>'},{id:"chart-pie",label:"Chart Pie",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11 2v20c-5.07-.5-9-4.79-9-10s3.93-9.5 9-10zm2.03 0v8.99H22c-.47-4.74-4.24-8.52-8.97-8.99zm0 11.01V22c4.74-.47 8.5-4.25 8.97-8.99h-8.97z"/></svg>'},{id:"leaf",label:"Leaf",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17 1.02.3 1.58.3C17 20 22 13.46 22 6c0-.55-.06-1.09-.14-1.62C20.18 4.15 18.66 4 17 4V2c1.67 0 3.35.12 5 .34V4c-1.67-.22-3.33-.34-5-.34v2zM2 6c0 7.46 5 14 14.5 14 .56 0 1.1-.13 1.58-.3l.95 2.3 1.89-.66C18.1 16.17 16 10 7 8c0 0-5 0-5 0z"/></svg>'},{id:"recycle",label:"Recycle",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5.77 7.15L7.2 4.78l1.03-1.71c.39-.65 1.33-.65 1.72 0l1.48 2.46-1.23 2.06-1 1.34-2.43-4.78zm15.95 5.82l-1.6-2.66-3.46 2L18.87 16H21v2l-3.87-7.03zM16 21h1.5l2.05-3.42-3.46-2-1.09 1.84L16 21zm-3.24-3.71l-1.03-1.71-1.43 2.43-2.43 4.78 1.6 2.66 3.46-2 1.03-1.71-1.43-2.45zM13.42 8.5l-1.48-2.46c-.39-.65-1.33-.65-1.72 0L9.22 7.15l-1 1.34 2.43 4.78 1.6-2.66 1.17-2.11zM10.5 14.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>'},{id:"energy",label:"Energy",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11.21 20H5V10h14v4.38l2-2V6c0-1.1-.9-2-2-2h-1V2h-2v2H8V2H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h6.21l-2-2zm5.33 2L23 13.13 21.59 11.6l-3.74 3.74L15 12.47V18h5.54z"/></svg>'},{id:"water",label:"Water",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8zm0 18c-3.35 0-6-2.57-6-6.2 0-2.34 1.95-5.44 6-9.14 4.05 3.7 6 6.79 6 9.14 0 3.63-2.65 6.2-6 6.2zm-3-6.2c0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3-3 1.34-3 3z"/></svg>'},{id:"eco",label:"Eco",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M6.05 8.05a7.007 7.007 0 0 0 0 9.9C7.42 19.32 9.21 20 11 20s3.58-.68 4.95-2.05C19.43 14.47 20 4 20 4S9.53 4.57 6.05 8.05zm8.49 8.49c-.95.94-2.2 1.46-3.54 1.46-.89 0-1.73-.25-2.48-.68.92-2.88 2.62-5.41 4.88-7.32-2.63 1.36-4.84 3.46-6.37 6-1.48-1.96-1.35-4.75.44-6.54C9.21 7.72 14.04 6.65 17.8 6.2c-.45 3.76-1.52 8.59-3.26 10.34z"/></svg>'},{id:"nature",label:"Nature",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M13 16.12c3.47-.41 6.17-3.36 6.17-6.95 0-3.87-3.13-7-7-7s-7 3.13-7 7c0 3.47 2.52 6.34 5.83 6.89V20H5v2h14v-2h-6v-3.88z"/></svg>'},{id:"sustainability",label:"Sustainability",svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3c-4.8 0-9 3.86-9 9 0 2.12.74 4.07 1.97 5.61L3 19.59 4.41 21l1.97-1.97C7.93 20.26 9.88 21 12 21c2.2 0 4.2-.9 5.7-2.3l-1.4-1.4c-1.1 1.1-2.6 1.7-4.3 1.7-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6v1.5l4 2-4 2V15c0-4.14-4.2-9-9-9zm0 3c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.3-3-3-3z"/></svg>'}],l=window.wp.element,c=((0,n.__)("Chart Bar","greenmetrics"),(0,n.__)("Chart Line","greenmetrics"),(0,n.__)("Chart Pie","greenmetrics"),(0,n.__)("Leaf","greenmetrics"),(0,n.__)("Recycle","greenmetrics"),(0,n.__)("Energy","greenmetrics"),(0,n.__)("Water","greenmetrics"),(0,n.__)("Eco","greenmetrics"),(0,n.__)("Nature","greenmetrics"),(0,n.__)("Sustainability","greenmetrics"),[{value:"carbon_footprint",label:(0,n.__)("Carbon Footprint","greenmetrics")},{value:"energy_consumption",label:(0,n.__)("Energy Consumption","greenmetrics")},{value:"data_transfer",label:(0,n.__)("Data Transfer","greenmetrics")},{value:"views",label:(0,n.__)("Page Views","greenmetrics")},{value:"http_requests",label:(0,n.__)("HTTP Requests","greenmetrics")},{value:"performance_score",label:(0,n.__)("Performance Score","greenmetrics")}]),s=(e,t=null)=>{if(!t)switch(e){case"carbon_footprint":return"{{carbon_footprint}}";case"energy_consumption":return"{{energy_consumption}}";case"data_transfer":return"{{data_transfer}}";case"views":return"{{views}}";case"http_requests":return"{{http_requests}}";case"performance_score":return"{{performance_score}}";default:return"{{0}}"}switch(e){case"carbon_footprint":return t.carbon_footprint?`${t.carbon_footprint}g CO2`:"0g CO2";case"energy_consumption":return t.energy_consumption?`${t.energy_consumption} kWh`:"0 kWh";case"data_transfer":return t.data_transfer?`${(t.data_transfer/1024).toFixed(2)} KB`:"0 KB";case"views":return t.total_views?t.total_views.toString():"0";case"http_requests":return t.requests?t.requests.toString():"0";case"performance_score":return t.performance_score?`${t.performance_score}%`:"0%";default:return"0"}};(0,t.registerBlockType)("greenmetrics/badge",{apiVersion:2,title:(0,n.__)("GreenMetrics Badge","greenmetrics"),description:(0,n.__)("Display a GreenMetrics badge with customizable styles.","greenmetrics"),icon:"chart-bar",category:"widgets",attributes:{text:{type:"string",default:"Eco-Friendly Site"},alignment:{type:"string",default:"left"},backgroundColor:{type:"string",default:"#4CAF50"},textColor:{type:"string",default:"#ffffff"},iconColor:{type:"string",default:"#ffffff"},showIcon:{type:"boolean",default:!0},iconName:{type:"string",default:"chart-bar"},iconSize:{type:"number",default:20},borderRadius:{type:"number",default:4},padding:{type:"number",default:8},showContent:{type:"boolean",default:!0},contentTitle:{type:"string",default:"Environmental Impact"},selectedMetrics:{type:"array",default:["carbon_footprint","energy_consumption"]},customContent:{type:"string",default:""},contentBackgroundColor:{type:"string",default:"#ffffff"},contentTextColor:{type:"string",default:"#333333"},contentPadding:{type:"number",default:15},animationDuration:{type:"number",default:300},showText:{type:"boolean",default:!0},textFontSize:{type:"number",default:14}},edit:({attributes:t,setAttributes:i})=>{const g=(0,r.useBlockProps)(),[m,u]=(0,l.useState)(null),[d,_]=(0,l.useState)(!0);(0,l.useEffect)((()=>{const e=wp.data.select("core/editor")?.getCurrentPostId();if(!e)return console.error("No post ID found"),void _(!1);wp.apiFetch({path:`/greenmetrics/v1/metrics?page_id=${e}`,method:"GET"}).then((e=>{u(e),_(!1);const t={data_transfer:e.data_transfer||0,load_time:e.load_time||0,requests:e.requests||0};console.log("Sending metrics data:",{url:greenmetricsTracking.ajax_url,action:greenmetricsTracking.action,nonce:greenmetricsTracking.nonce,metrics:t}),jQuery.ajax({url:greenmetricsTracking.ajax_url,type:"POST",data:{action:greenmetricsTracking.action,nonce:greenmetricsTracking.nonce,metrics:JSON.stringify(t)},success:function(e){console.log("Metrics saved successfully:",e)},error:function(e,t,n){console.error("Error sending metrics to server:",n)}})})).catch((e=>{console.error("Error fetching metrics:",e),_(!1)}))}),[]);const{text:p,alignment:v,backgroundColor:h,textColor:b,iconColor:f,showIcon:w,iconName:C,iconSize:x,borderRadius:y,padding:E,showContent:k,contentTitle:z,selectedMetrics:S,customContent:B,contentBackgroundColor:N,contentTextColor:T,contentPadding:M,animationDuration:H,showText:P,textFontSize:$}=t;return(0,e.createElement)("div",{...g},(0,e.createElement)(r.InspectorControls,null,(0,e.createElement)(o.PanelBody,{title:(0,n.__)("Badge Settings","greenmetrics")},(0,e.createElement)(o.ToggleControl,{label:(0,n.__)("Show Icon","greenmetrics"),checked:w,onChange:e=>i({showIcon:e}),__nextHasNoMarginBottom:!0}),w&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"icon-selector"},(0,e.createElement)("p",null,(0,n.__)("Select Icon","greenmetrics")),(0,e.createElement)("div",{className:"icon-grid"},a.map((t=>{const n=t.id===C;return(0,e.createElement)("button",{key:t.id,className:"icon-button "+(n?"selected":""),onClick:()=>{console.log("Setting icon to:",t.id),i({iconName:t.id})},dangerouslySetInnerHTML:{__html:t.svg},style:{color:f}})})))),(0,e.createElement)(o.RangeControl,{label:(0,n.__)("Icon Size","greenmetrics"),value:x,onChange:e=>i({iconSize:e}),min:16,max:48,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})),(0,e.createElement)("hr",null),(0,e.createElement)(o.ToggleControl,{label:(0,n.__)("Show Text","greenmetrics"),checked:P,onChange:e=>i({showText:e}),__nextHasNoMarginBottom:!0}),P&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.TextControl,{label:(0,n.__)("Badge Text","greenmetrics"),value:p,onChange:e=>i({text:e}),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,e.createElement)(o.RangeControl,{label:(0,n.__)("Text Size","greenmetrics"),value:$,onChange:e=>i({textFontSize:e}),min:12,max:24,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})),(0,e.createElement)("hr",null),(0,e.createElement)(o.RangeControl,{label:(0,n.__)("Border Radius","greenmetrics"),value:y,onChange:e=>i({borderRadius:e}),min:0,max:20,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,e.createElement)(o.RangeControl,{label:(0,n.__)("Badge Padding","greenmetrics"),value:E,onChange:e=>i({padding:e}),min:4,max:20,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})),(0,e.createElement)(o.PanelBody,{title:(0,n.__)("Content Settings","greenmetrics")},(0,e.createElement)(o.ToggleControl,{label:(0,n.__)("Show Content","greenmetrics"),checked:k,onChange:e=>i({showContent:e}),__nextHasNoMarginBottom:!0}),k&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.TextControl,{label:(0,n.__)("Content Title","greenmetrics"),value:z,onChange:e=>i({contentTitle:e}),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,e.createElement)(o.RangeControl,{label:(0,n.__)("Content Padding","greenmetrics"),value:M,onChange:e=>i({contentPadding:e}),min:10,max:30,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,e.createElement)("div",{className:"components-base-control"},(0,e.createElement)("label",{className:"components-base-control__label"},(0,n.__)("Select Metrics","greenmetrics")),c.map((t=>(0,e.createElement)(o.CheckboxControl,{key:t.value,label:t.label,checked:S.includes(t.value),onChange:e=>{const n=e?[...S,t.value]:S.filter((e=>e!==t.value));i({selectedMetrics:n})},__nextHasNoMarginBottom:!0})))),(0,e.createElement)(o.TextControl,{label:(0,n.__)("Custom Content","greenmetrics"),value:B,onChange:e=>i({customContent:e}),help:(0,n.__)("Add any additional content to display below the metrics","greenmetrics"),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,e.createElement)(o.RangeControl,{label:(0,n.__)("Animation Duration (ms)","greenmetrics"),value:H,onChange:e=>i({animationDuration:e}),min:100,max:1e3,step:100,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}))),(0,e.createElement)(r.PanelColorSettings,{title:(0,n.__)("Color Settings","greenmetrics"),colorSettings:[{value:h,onChange:e=>i({backgroundColor:e}),label:(0,n.__)("Badge Background Color","greenmetrics")},w&&{value:f,onChange:e=>i({iconColor:e}),label:(0,n.__)("Icon Color","greenmetrics")},P&&{value:b,onChange:e=>i({textColor:e}),label:(0,n.__)("Text Color","greenmetrics")},{value:N,onChange:e=>i({contentBackgroundColor:e}),label:(0,n.__)("Content Background Color","greenmetrics")},{value:T,onChange:e=>i({contentTextColor:e}),label:(0,n.__)("Content Text Color","greenmetrics")}].filter(Boolean)})),(0,e.createElement)(r.BlockControls,null,(0,e.createElement)(r.AlignmentToolbar,{value:v,onChange:e=>i({alignment:e})})),(0,e.createElement)("div",{className:"wp-block-greenmetrics-badge-wrapper"},(0,e.createElement)("div",{className:"wp-block-greenmetrics-badge",style:{backgroundColor:h,color:b,padding:`${E}px`,borderRadius:`${y}px`,textAlign:v,cursor:k?"pointer":"default"}},w&&(0,e.createElement)("div",{className:"wp-block-greenmetrics-badge__icon",style:{width:`${x}px`,height:`${x}px`,color:f},dangerouslySetInnerHTML:{__html:a.find((e=>e.id===C))?.svg||a[0].svg}}),P&&(0,e.createElement)("span",{style:{color:b,fontSize:`${$}px`}},p)),k&&(0,e.createElement)("div",{className:"wp-block-greenmetrics-content",style:{backgroundColor:N,color:T,padding:`${M}px`,transition:`all ${H}ms ease-in-out`}},(0,e.createElement)("h3",null,z),(0,e.createElement)("div",{className:"wp-block-greenmetrics-metrics"},S.map((t=>(0,e.createElement)("div",{key:t,className:"wp-block-greenmetrics-metric"},(0,e.createElement)("div",{className:"metric-label"},(0,e.createElement)("span",null,c.find((e=>e.value===t))?.label),(0,e.createElement)("span",{className:"metric-value"},s(t,m))))))),B&&(0,e.createElement)("div",{className:"wp-block-greenmetrics-custom-content"},B))))},save:({attributes:t})=>{const n=r.useBlockProps.save(),{text:o,alignment:l,backgroundColor:i,textColor:g,iconColor:m,showIcon:u,iconName:d,iconSize:_,borderRadius:p,padding:v,showContent:h,contentTitle:b,selectedMetrics:f,customContent:w,contentBackgroundColor:C,contentTextColor:x,contentPadding:y,animationDuration:E,showText:k,textFontSize:z}=t,S=a.find((e=>e.id===d));S||console.error("Icon not found:",d);const B=S?S.svg:a[0].svg;return(0,e.createElement)("div",{...n},(0,e.createElement)("div",{className:"wp-block-greenmetrics-badge-wrapper"},(0,e.createElement)("div",{className:"wp-block-greenmetrics-badge",style:{backgroundColor:i,color:g,padding:`${v}px`,borderRadius:`${p}px`,textAlign:l,cursor:h?"pointer":"default"}},u&&(0,e.createElement)("div",{className:"wp-block-greenmetrics-badge__icon",style:{width:`${_}px`,height:`${_}px`,color:m},dangerouslySetInnerHTML:{__html:B}}),k&&(0,e.createElement)("span",{style:{color:g,fontSize:`${z}px`}},o)),h&&(0,e.createElement)("div",{className:"wp-block-greenmetrics-content",style:{backgroundColor:C,color:x,padding:`${y}px`,transition:`all ${E}ms ease-in-out`}},(0,e.createElement)("h3",null,b),(0,e.createElement)("div",{className:"wp-block-greenmetrics-metrics"},f.map((t=>(0,e.createElement)("div",{key:t,className:"wp-block-greenmetrics-metric"},(0,e.createElement)("div",{className:"metric-label"},(0,e.createElement)("span",null,c.find((e=>e.value===t))?.label),(0,e.createElement)("span",{className:"metric-value"},s(t))))))),w&&(0,e.createElement)("div",{className:"wp-block-greenmetrics-custom-content",dangerouslySetInnerHTML:{__html:w}}))))}})}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,e=[],r.O=(t,n,o,a)=>{if(!n){var l=1/0;for(g=0;g<e.length;g++){for(var[n,o,a]=e[g],c=!0,s=0;s<n.length;s++)(!1&a||l>=a)&&Object.keys(r.O).every((e=>r.O[e](n[s])))?n.splice(s--,1):(c=!1,a<l&&(l=a));if(c){e.splice(g--,1);var i=o();void 0!==i&&(t=i)}}return t}a=a||0;for(var g=e.length;g>0&&e[g-1][2]>a;g--)e[g]=e[g-1];e[g]=[n,o,a]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[l,c,s]=n,i=0;if(l.some((t=>0!==e[t]))){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(s)var g=s(r)}for(t&&t(n);i<l.length;i++)a=l[i],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(g)},n=globalThis.webpackChunkgreenmetrics_badge_block=globalThis.webpackChunkgreenmetrics_badge_block||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[350],(()=>r(731)));o=r.O(o)})();